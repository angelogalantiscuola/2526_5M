{% extends 'base.html' %}

{% block content %}
<h1>Blog della Classe</h1>

<!-- Mostra il tasto 'Nuovo' solo se sei loggato -->
{% if g.user %}
<a href="{{ url_for('main.create') }}" class="btn">Scrivi un nuovo post</a>
<a href="{{ url_for('main.bookmarks') }}" class="btn">I miei Preferiti</a>
<hr>
{% endif %}

{% for post in posts %}
<article>
  <header>
    <!-- Titolo del post -->
    <h2>{{ post['title'] }}</h2>
    <!-- Info autore e data -->
    <small>Scritto da <a href="{{ url_for('main.user_profile', id=post['author_id']) }}"><strong>{{ post['username']
          }}</strong></a> il {{ post['created'].strftime('%Y-%m-%d') }}</small>
  </header>

  <!-- Corpo del post -->
  <p>{{ post['body'] }}</p>

  <!-- Tasto Modifica (visibile solo all'autore) -->
  {% if g.user and g.user['id'] == post['author_id'] %}
  <a href="{{ url_for('main.update', id=post['id']) }}">Modifica</a>
  {% endif %}

  <!-- Bottone Preferiti (solo se loggato) -->
  {% if g.user %}
  <form method="post" action="{{ url_for('main.toggle_bookmark', id=post['id']) }}" style="display:inline;">
    {% if post['id'] in bookmarked_ids %}
    <button type="submit">â˜… Salvato</button>
    {% else %}
    <button type="submit">â˜† Salva</button>
    {% endif %}
  </form>
  {% endif %}
</article>
<hr>
{% endfor %}

<a href="{{ url_for('main.archive') }}">ðŸ“… Archivio per data</a>
{% endblock %}